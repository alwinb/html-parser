var we=Object.defineProperty;var Ue=r=>we(r,"__esModule",{value:!0});var se=(r,i)=>{Ue(r);for(var n in i)we(r,n,{get:i[n],enumerable:!0})};var xe={};se(xe,{Any:()=>V,C:()=>t,E:()=>e,None:()=>d,kinds:()=>I,otherKind:()=>X,printKind:()=>ee});var kt=console.log.bind(console),We=`html body head caption colgroup optgroup option select tr script div
  template col button p table li frameset frame noframes math svg br xmp
  a nobr font textarea meta hr style input keygen annotation-xml embed
  img image noscript title form`.split(/\s+/g),ie={DATA:"#data",COMMENT:"#comment",SPACE:"#space",TEXT:"#text",h1_h6:"h1 h2 h3 h4 h5 h6",tbody:"tbody tfoot thead",cell:"td th",list:"ol ul",dddt:"dd dt",_fmt0:"b big code em i s small strike strong tt u",_void0:"area wbr",_void1:"param source track",_meta0:"base basefont bgsound link",_break:"sub sup var ruby span",_scope:"applet marquee object",_block1:"blockquote center dl menu",_block2:"listing pre",_block3:`article aside details dir fieldset figcaption
            figure footer header hgroup main nav
            plaintext section summary address`},Y=0n,Z={},G={};for(let r of We)Z[r]=1n<<Y++;for(let r in ie)G[r]=1n<<Y++;G.other=1n<<Y++;G.htmlFont=1n<<Y++;G.hiddenInput=1n<<Y++;G.annotationHtml=1n<<Y++;G.annotationXml=Z["annotation-xml"];var I={};for(let r in Z)I[r]=(I[r]||0n)|Z[r];for(let r in ie)for(let i of ie[r].split(/\s+/))I[i]=(I[i]||0n)|G[r];function ee(r){if(r===~0n)return"Any";if(r===0n)return"None";let i=r<0n?~r:r,n=[];for(let A in e)i&e[A]&&n.push("E."+A);for(let A in G)G[A]&i&&n.push("C."+A);return`${r<0n?"~":""}`+(n.length===1?n[0]:`(${n.join(" | ")})`)}var e=Z,t=Object.assign({},G),X=t.other,d=0n,V=-1n;t.void=t._void0|t._void1|e.input|e.keygen|e.embed|e.img|t._meta0|e.meta|e.br|e.col|e.frame|e.hr|t.hiddenInput;t.meta=t._meta0|e.noscript|e.title|e.style|e.script|e.template|e.meta|e.noframes;t.format=t._fmt0|e.a|e.font|e.nobr|t.htmlFont;t._specialBlock=t._block1|t._block2|t._block3|e.form;t.special=t._specialBlock|e.p|e.div|e.li|t.list|t.h1_h6|t.dddt|e.button;t.foreign=e.math|e.svg;t.RcData=e.textarea|e.title;t.RawText=e.style|e.script|e.xmp|e.noframes;t.formatContext=e.html|e.template|e.caption|e.table|t.cell|t._scope;t.reformat=t._void0|e.input|e.keygen|t._scope|t.other|t.format|e.select|e.optgroup|e.option|e.button|e.math|e.svg|e.br|e.xmp|t.TEXT|t.SPACE,t.bodyContent=~(e.body|e.html|e.head|e.frameset|e.frame|e.caption|e.colgroup|e.col|t.tbody|e.tr|t.cell|t.DATA);t.pContent=t.bodyContent&~(e.p|e.div|t._specialBlock|t.dddt|t.h1_h6|t.list|e.li|e.xmp);t.tableIsh=e.table|e.caption|e.colgroup|e.col|t.tbody|e.tr|t.cell;t.tableContent=e.caption|e.colgroup|t.tbody|e.script|e.template|e.style|t.hiddenInput|t.SPACE|t.COMMENT;t.trContent=e.script|e.style|e.template|t.cell|t.hiddenInput|t.SPACE|t.COMMENT;t.tbodyContent=e.script|e.style|e.template|e.tr|t.hiddenInput|t.SPACE|t.COMMENT;t.breakout=e.body|e.br|e.head|e.li|e.p|e.table|e.div|t._block1|t._block2|t._break|e.meta|t._fmt0|e.nobr|t.dddt|t.h1_h6|t.list|e.embed|e.img|e.hr|t.htmlFont;t.foreignContent=~t.breakout&~t.DATA;t.closeSelect=e.input|e.keygen|e.textarea;t.startTagExceptions=e.select|e.image|e.input|e.font|t.annotationXml|e.a|e.nobr|e.body|e.head|e.frameset;t.endTagExceptions=e.br|e.p|e.body|e.head|t.h1_h6;t.framesetOK=e.optgroup|e.option|e.div|e.p|t.h1_h6|t.list|t.format|t._void1|t._block1|t._block3|e.form|t.other|t.COMMENT|t.SPACE|e.html|e.head|t._break|t.hiddenInput|e.frame|e.frameset|e.noframes|e.body;t.metaRedirect=t.meta&~e.noscript;t.fosterParented=~(t.tableIsh|e.script|e.template|e.style|t.hiddenInput|t.COMMENT|t.SPACE|t.DATA);var ve={};se(ve,{childRule:()=>de,documentRule:()=>te,fragmentRule:()=>ze,ruleInfo:()=>ce,siblingRule:()=>le});var Ft=console.log.bind(console);function ce(r){let i=Object.assign({},r);for(let n in i)typeof i[n]=="bigint"&&(i[n]=ee(i[n]));return i}var $e={},te={name:"#document",content:e.html|t.COMMENT,openFor:~t.SPACE,paths:{"#default":"html"},siblingRules:!0},ze={name:"#fragment",escalate:d,content:t.bodyContent},Ve={content:e.html|t.COMMENT,openFor:~t.SPACE,paths:{"#default":"html"},siblingRules:!0},Ee={content:e.head|t.COMMENT,openFor:~t.SPACE,paths:{"#default":"head"},siblingRules:!0},Je={allowEnd:d,escalate:~(e.frame|e.head),content:t.meta|t.SPACE|t.COMMENT},Qe={escalate:d,content:e.body|e.frameset|t.COMMENT,openFor:~(t.metaRedirect|e.frame|e.frameset|t.SPACE|t.DATA),paths:{"#default":"body"},redirect:t.metaRedirect|t.DATA,reparent:t.SPACE,siblingRules:!0},Ye={escalate:d,content:t.bodyContent,reparent:e.frameset},q={content:t.SPACE|t.DATA,escalate:V},Ze={content:t.COMMENT,_reopen:~t.COMMENT},et={escalate:d,content:t.COMMENT,_reopen:~t.COMMENT},tt={escalate:d,content:e.frameset|e.frame|e.noframes|t.SPACE|t.COMMENT},nt={content:e.noframes|t.SPACE|t.COMMENT},ot={content:t.COMMENT,redirect:e.noframes|t.SPACE|t.DATA},rt={allowEnd:d,escalate:e.table,content:t.tableContent,openFor:e.col|e.tr|t.cell,paths:{col:"colgroup",tr:"tbody",td:"tbody",th:"tbody"},reparent:t.fosterParented},lt={allowEnd:e.table,content:t.bodyContent},at={allowEnd:e.table,content:e.col|t.hiddenInput|e.template|t.SPACE,escalate:V,reparent:d},fe={allowEnd:e.table,escalate:t.tableIsh&~(e.tr|t.cell),openFor:t.cell,paths:{td:"tr",th:"tr"},content:t.tbodyContent,reparent:t.fosterParented},st={allowEnd:e.table|t.tbody,escalate:t.tableIsh&~t.cell,content:t.trContent,reparent:t.fosterParented},Te={allowEnd:e.table|e.tr|t.tbody,escalate:t.tableIsh,content:t.bodyContent},Ce={allowEnd:d,escalate:t.closeSelect,content:e.option|e.optgroup|e.script|e.template|t.TEXT|t.SPACE},it={content:e.option|e.script|e.template|t.TEXT|t.SPACE,forbid:e.optgroup},ct={content:e.script|e.template|t.TEXT|t.SPACE,escalate:t.closeSelect|t.tableIsh|e.option|e.optgroup},Ae=t.tableIsh&~(e.colgroup|e.col),ft={allowEnd:t.tableIsh,escalate:t.closeSelect|Ae,content:e.option|e.optgroup|e.script|e.template|t.TEXT|t.SPACE},ue={allowEnd:t.tableIsh,escalate:t.tableIsh,content:t.bodyContent},ut={content:t.bodyContent},J=e.option|e.optgroup|t.other|e.svg|e.math|e.body,_e={allowEnd:~(J|e.form|e.li),allow:t.bodyContent&~e.button},dt={allowEnd:~(J|e.form),allow:t.bodyContent&~e.button},pt={allowEnd:~(J|e.form|e.p),allow:t.bodyContent&~e.button,forbid:e.button},mt={escalate:~e.form,allow:t.bodyContent&~(e.button|e.form),forbid:e.form},ht={allowEnd:~(J|e.form),allow:t.bodyContent&~(e.button|e.form|t.h1_h6),forbid:t.h1_h6},bt={allowEnd:~J,allow:t.bodyContent&~(e.button|e.form|e.li),forbid:e.li},Pe={allowEnd:~J,allow:t.bodyContent&~(e.button|e.form|t.dddt),forbid:t.dddt},gt={allowEnd:~J,allow:t.pContent&~e.button,forbid:~t.pContent},yt={allowEnd:~(e.svg|e.math|e.body),allow:(t.pContent|t.h1_h6)&~e.button,forbid:e.option|e.optgroup},oe={allowEnd:~(e.svg|e.math|e.form|e.body),allow:(t.pContent|t.h1_h6)&~e.button},ne={namespace:e.svg,allowEnd:~(e.html|e.body),escalate:t.breakout,content:t.foreignContent},wt={namespace:e.svg,allowEnd:~(e.html|e.body),escalate:t.breakout,content:t.foreignContent},re={namespace:e.math,allowEnd:~(e.html|e.body),escalate:t.breakout|Ae,content:t.foreignContent},W={namespace:d,allowEnd:e.svg|e.math,escalate:d,content:t.bodyContent},Me={namespace:d,allowEnd:e.svg|e.math|t.tableIsh,escalate:t.tableIsh,content:t.bodyContent},Oe={html:Ee,head:Je,body:Ye,frameset:tt,template:{allowEnd:d,content:~(e.body|e.frameset|e.frame|t.DATA)},applet:ue,object:ue,marquee:ue,svg:ne,math:re,select:Ce,dl:dt,ol:_e,ul:_e,li:bt,dt:Pe,dd:Pe,form:mt,button:pt,p:gt,div:oe,address:oe,style:q,script:q,xmp:q,iframe:q,noembed:q,noframes:q,textarea:q,title:q,plaintext:q,"#comment":q,table:rt,caption:lt,colgroup:at,thead:fe,tbody:fe,tfoot:fe,tr:st,th:Te,td:Te};var xt={svg:ne,math:re,foreignObject:W,title:W},Et={svg:ne,math:re,mi:W,mo:W,mn:W,ms:W,mtext:W};function de({namespace:r,closable:i},n,A){return r&e.math?A&t.annotationHtml?i&e.table?Me:W:Et[n]||re:r&e.svg?n==="desc"?i&e.table?Me:W:xt[n]||ne:A&e.svg?i&e.table?wt:ne:A&e.select?i&e.table?ft:Ce:A&e.option?i&e.select?ct:yt:A&e.optgroup?i&e.select?it:oe:A&t.h1_h6?ht:n in Oe?Oe[n]:A&t._specialBlock?ut:i&e.p?$e:oe}function le({kind:r,children:i},n,A,k){return r===d?i&e.html?k&e.frameset?ot:et:Ve:r&e.html?i&e.frameset?nt:i&e.body?Ze:i&e.head?Qe:Ee:null}var ke={};se(ke,{Document:()=>pe,Element:()=>F,EndTag:()=>$,MDecl:()=>me,htmlns:()=>Tt});var Tt="http://www.w3.org/1999/xhtml",Se=!0;function pe(){Object.defineProperties(this,{head:{writable:Se},body:{writable:Se}}),this.children=[]}function F(r,i){this.name=r,i&&(this.attrs=i),this.children=[]}function me(){this.type="MDecl",this.name}function $(r){this.type="EndTag",this.name=r}var{defineProperties:Ct}=Object,It=console.log.bind(console),L=new TextDecoder;L=L.decode.bind(L);var Nt=Symbol("RAW"),jt=Symbol("DATA"),Bt=Symbol("RCDATA");function De({writeTag:r,writeEndTag:i,writeData:n,writeSpace:A,writeNulls:k,writeMDecl:K,writeEOF:w}){let T,l=0,g=-1,R=-1,o=null,c="",P=null,p=null,O=null,v=null,x=null,M=null,m=null,u=null,y=0,S=0;function H(){return{anchor:l,tagStart:g,refStart:R,_raw:o,emit:T,space:P,_tagname:c,tag:p,attributes:v,attribute:x,name:M,assign:m,value:u,quotation:y,last:S}}return Ct(this,{state:{get:H}}),Object.assign(this,{parse:z,end:N});function D(){}function N(){w()}function z(C){typeof C=="string"&&(C=new Uint8Array(new TextEncoder().encode(C)));for(let s=0,Q=C.length;s<Q;s++){let a=C[s];if(y){a===y||a===9&&y===32?(x.value=L(C.subarray(l,l=s)),y=u=m=M=x=null):a===62&&y===32&&(x.value=L(C.subarray(l,l=s)),o=T(p).raw,y=u=m=M=x=v=p=O=null,l=s+1);continue}if(m){a===34||a===39?(y=a,l=s+1):a===62?(S===47&&(p.selfclose=!0),o=T(p).raw,u=m=M=x=v=p=O=null,l=s+1):a!==32&&a!==9&&a!==10&&a!==13&&(y=32,l=s);continue}if(M){a===61?(l=s+1,m=a):a===47?(l=s+1,M=x=null):a===62?(S===47&&(p.selfclose=!0),o=T(p).raw,l=s+1,M=x=v=p=O=null):a!==32&&a!==9&&a!==10&&a!==13&&(v.push(x={}),M=null,l=s),S=a;continue}if(x){if(a===61){let j=L(C.subarray(l,l=s));x.name=M=j,m=!0,l=s+1}else a===32&&a===9&&a===10&&a===13?(M=x.name=L(C.subarray(l,l=s)),l=s+1):a===47?(x.name=L(C.subarray(l,l=s)),l=s+1,u=m=M=x=null):a===62&&(x.name=L(C.subarray(l,l=s)),S===47&&(p.selfclose=!0),o=T(p).raw,l=s+1,u=m=M=x=v=p=O=null);S=a;continue}if(v){a===62?(S===47&&(p.selfclose=!0),o=T(p).raw,v=p=O=null,l=s+1):a!==32&&a!==9&&a!==10&&a!==13&&a!==47?(v.push(x={}),l=s):l=s+1,S=a;continue}if(p){if(a===32||a===9||a===47){let j=L(C.subarray(l,s));!o||O&&j===c?(c=p.name=j,v=p.attributes=[],g=-1,l=s):(p=O=null,l=g,g=-1)}else if(a===62){let j=L(C.subarray(l,s));!o||O&&j===c?(c=p.name=j,S===47&&(p.selfclose=!0),o=T(p).raw,l=s+1,g=-1,p=O=null):(p=O=null,l=g,g=-1)}S=a;continue}if(g>=0){let j=s-g;!o&&(65<=a&&a<=90||97<=a&&a<=122)?(p=new F,T=r,l=s):a===47&&j===1?(p=O=new $,T=i,l=s+1):j===1&&(a===33||a===63||a===47)?(p=new me,T=K,l=s+1):(l=g,g=-1);continue}if(a===60){g=s,l<s&&n(C.subarray(l,l=s));continue}if(a===38){R=s,l<s&&n(C.subarray(l,l=s));continue}if(a===32||a===9){l<s&&n(C.subarray(l,l=s));do a=C[++s];while((a===32||a===9)&&s<Q);A(C.subarray(l,l=s--));continue}if(a===10||a===13){l<s&&n(C.subarray(l,l=s));do a=C[++s];while((a===10||a===13)&&s<Q);A(C.subarray(l,l=s--));continue}if(a===0){l<s&&n(C.subarray(l,l=s));do a=C[++s];while(a===0&&s<Q);k(C.subarray(l,l=s--));continue}}p||l<C.length&&n(C.subarray(l))}}var{defineProperty:Fe,assign:At,setPrototypeOf:_t}=Object,Re=!0,Ie=(r,i)=>{for(let n in i)Fe(r,n,{value:i[n],configurable:Re})},Pt=(r,i)=>{for(let n in i)Fe(r,n,{get:i[n],configurable:Re})},Ht=console.log.bind(console),Ne=ee,he=({childRule:r,siblingRule:i,ruleInfo:n})=>{class A{constructor(w,T){let l={namespace:d,name:w.name,kind:d,closable:d,openable:d,content:d,node:w};return this.applyRule.call(l,T)}applyRule(w,{name:T,kind:l,node:g,children:R=d}=this){let{namespace:o=this.namespace,allowEnd:c=V,escalate:P=V,content:p=this.content,allow:O=d,forbid:v=d,openFor:x=d,paths:M=null,redirect:m=d,redirectTo:u=this.redirectTo,reparent:y=d,fosterParent:S=this.fosterParent,_reopen:H=d,siblingRules:D=!1}=w,N=(p|y|O)&~v,z=_t({namespace:o,name:T,kind:l,children:R,closable:this.closable&c,openable:this.openable&P|N|x,content:N,openFor:x,paths:M,redirect:m&~N,redirectTo:u,fosterParent:S,siblingRules:D,_reopen:H,reparent:y,node:g},A.prototype);return Ie(g,{frame:z}),z}child(w,T,l,g=new F(w,l)){let R=r(this,w,T,this.children),o=this.applyRule(R,{name:w,kind:T,node:g});return o.closable|=T,o}_select(w,T){for(let l of this.node.children)if(l.name===w)return this.child(w,T,null,l);return null}get info(){let w=At({},this);for(let T in w)typeof w[T]=="bigint"&&(w[T]=Ne(w[T]));return w.redirectTo=this.redirectTo?.name,w.fosterParent=this.fosterParent?.name,delete w.node,w}}function k({context:K,node:w,minDepth:T=1,verbose:l=!1}){let g=this,R,o,c,P,p,O,v=d,x,M=d,m;return Pt(this,{stack:()=>c,tip:()=>o,document:()=>R,allOpened:()=>p,allClosed:()=>O}),Ie(this,{reset:u,_onopen:y,_onclose:S,log:ge,prepare:H,tryOpen:D,tryAppend:N,tryClose:z,_open:C,_select:qe,_reformat:a,canClose:j}),u();function u(){return R=w||new F(K.name||"#root"),o=new A(R,K),c=[o],P=[],p=d,O=d,g}function y(h,f){v=h,x=f}function S(h,f){M=h,m=f}function H(h,f,E=o.namespace){for(let b=0;b<3;b++){if(f&o.content)return g;let _=Ke(h,f,E);if(_){let U=s(_.index+1);if(_.done)return g}let B=Ge(h,f);if(B&&B.path.length){for(let U of B.path){let ae=o.reparent&f?o.fosterParent:o.node,ye=ae.children.length;ae.children[ye]=U.node,o.children|=U.kind,c.push(o=U),p|=U.kind,v&U.kind&&x(U.name,U.kind,U.node,ae,ye)}if(B.done)return g}}return null}function D(h,f=I[h]||X,E,b){return H(h,f,b)?C(h,f,E):null}function N(h,f=I[h]||X){return ge("try append ::",Ne(f)),H(h?h.name:null,f)?((o.reparent&f?o.fosterParent:o.node).children.push(h),o.children|=f,p|=f,g):null}function z(h,f=I[h]||X){let E=j(h,f);return E&&s(E.index)?g:null}function C(h,f,E){let b=o.child(h,f,E),_=o.reparent&f?o.fosterParent:o.node,B=_.children.length;return _.children[B]=b.node,o.children|=f,c.push(o=b),p|=f,v&f&&x(h,f,b.node,_,B),g}function s(h=c.length-1){if(h<T)return null;let f=[],E=d,b;for(;c.length>h;){let _=c.pop();E=_.kind,b=_.name,O|=_.kind,f.push(_),P.push(_)}return E&t.format&&P.length&&P.pop(),o=c[c.length-1],o.siblingRules&&Q(b,E),f}function Q(h,f){c.pop();let E=i(o,h,f,p);E!=null&&(c[c.length]=o=o.applyRule(E))}function a(){let h={},f=[];for(let{name:E,kind:b}of P)b&t.format?(h[E]=(h[E]||0)+1)<=3&&f.unshift({name:E,kind:b}):b&t.formatContext&&(h={},f=[]);for(let{name:E,kind:b}of f)g.tryOpen(E,b);P=[]}function j(h,f,E=null){for(let b=c.length-1;b>=0;b--){let _=c[b];if(_.name===h)return{index:b,frame:_};if(h===null&&_.kind&f)return{index:b,frame:_};if(!(_.closable&f))return null}}function Ke(h,f,E){if(f&o.openable)for(let b=c.length-1;b>=0;b--){let _=c[b],B=E===_.namespace;if(B&&f&_.content)return{index:b,frame:_,done:!0};if(B&&f&_.openFor)return{index:b,frame:_,done:!1}}}function Ge(h,f){let E=[],b=o,_;if(f&o.openFor)for(;b&&!(b.content&f)&&b.openFor&f;){let B=h in b.paths?b.paths[h]:b.paths["#default"];b=b.child(B,I[B]||X),E.push(b)}return E.length?{path:E,done:b.content&f}:null}function qe(h,f){let E=o._select(h,f);return E&&c.push(o=E),E?g:null}function ge(...h){return l&&console.log(`
`+c.map(f=>f.name).join(" > "),...h.length?["::",...h]:[]),g}}return k};var{defineProperty:je,assign:qt,setPrototypeOf:Ut}=Object,Be=!0,Le=(r,i)=>{for(let n in i)je(r,n,{value:i[n],configurable:Be})},Mt=(r,i)=>{for(let n in i)je(r,n,{get:i[n],configurable:Be})},be=he({childRule:de,siblingRule:le,ruleInfo:ce}),Ot={color:1,face:1,size:1},vt={altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient",textpath:"textPath"};function He(r){let i=[],n={closable:0n,namespace:0n,allOpened:0n,allClosed:0n};Le(this,{writeTag:A,writeEndTag:k,writeSpace:w,writeData:T,writeMDecl:l,writeNulls:K,writeEOF:g});function A(o){o=R(o);let c=I[o.name]||X,{head:P,body:p,closable:O,namespace:v}=n,x=o.attributes;switch(c&t.startTagExceptions){case e.body:case e.head:return n=v?r.writeEndTag(new $(v&e.svg?"svg":"math")):r.writeTag(o);case e.select:return n=O&e.select?r.writeEndTag(new $("select")):r.writeTag(o);case e.frameset:return n.allOpened&~t.framesetOK?n:n=r.writeTag(o);case e.image:return n=r.writeTag(new F("img"));case e.a:return O&e.a&&(n=r.writeEndTag(o)),n=r.writeTag(o);case e.nobr:return O&e.nobr&&(n=r.writeEndTag(o)),n=r.writeTag(o);case e.input:for(let{name:M,value:m}of x||[])if(M==="type"&&m.toLowerCase()==="hidden")return n=r.writeTag(o,t.hiddenInput);return n=r.writeTag(o);case e.font:for(let{name:M,value:m}of x||[])if(M.toLowerCase()in Ot)return n=r.writeTag(o,t.htmlFont);return n=r.writeTag(o,e.font);case t.annotationXml:if(v&e.math&&x){for(let{name:M,value:m}of x)if(M==="encoding"){let u=m.toLowerCase();if(u==="text/html"||u==="application/xhtml+xml")return n=r.writeTag(o,t.annotationHtml)}}return n=r.writeTag(o,t.annotationXml)}return o.selfclose&&v&(e.svg|e.math)?(n=r.writeTag(o),n=r.writeEndTag(new $(o.name))):n=r.writeTag(o)}function k(o){o=R(o);let c=I[o.name]||X,{closable:P}=n;if(c&t.endTagExceptions){if(c&e.br)return n=r.writeTag(new F("br"));if(c&e.body)return n.allClosed&e.head||r.writeTag(new F("body")),n=r.writeEndTag(o);if(c&t.h1_h6&&P&t.h1_h6||c&t.annotationXml)return n=r.writeEndTag({name:null,kind:c});if(c&e.p&&n.body&&!(P&e.p)||c&e.head&&!n.head)return r.writeTag(new F(o.name)),n=r.writeEndTag(new $(o.name))}return n=r.writeEndTag(o)}function K(o){if(n.namespace){let c=new Uint8Array(o.length*3);for(let P=0,p=c.length;P<p;P+=3)c[P]=239,c[P+1]=191,c[P+2]=189;return n=r.writeData(c)}else return n=r.writeNulls(o)}function w(o){return n=r.writeSpace(o)}function T(o){return n=r.writeData(o)}function l(o){return n=r.writeMDecl(o)}function g(){return n=r.writeEOF()}function R(o){let c=o.name.toLowerCase();if(n.namespace&e.svg&&(c=vt[c]||c),o.name===c)return o;if(o instanceof F){let P=new F(c,o.attributes);return P.children=[],P.selfclose=o.selfclose,P}else return new $(c)}}function Xe({context:r=te,verbose:i=!1}={}){let n=new be({node:new pe,context:r,verbose:i,documentRule:te}),A=e.html|e.head|e.body|e.frameset|e.table;n._onopen(A,R);let k,K,w,T,l=this;return Mt(this,{document:()=>n.document,stack:()=>n.stack,builder:()=>n}),Le(this,{writeTag:c,writeEndTag:P,writeData:p,writeSpace:O,writeNulls:v,writeMDecl:x,writeEOF:M}),this;function g(){let{allClosed:m,allOpened:u}=n,{closable:y,namespace:S,content:H}=n.tip;return{namespace:S,head:K,body:w,closable:y,allOpened:u,allClosed:m,raw:H&t.DATA}}function R(m,u,y,S,H){switch(u){case e.html:return k=y;case e.body:return T=H,n.tip.fosterParent=S,n.document.body=w=y,w;case e.head:{n.document.head=K=y;let D=n.tip;return n.stack[1].redirectTo=new be({context:D,node:D.node,verbose:i}),n.stack[1].fosterParent=k,k}case e.frameset:{let D=n.stack[1];D=D.applyRule(le(D,m,u,n.allOpened|e.frameset));let N=new be({context:D,verbose:i});return n.stack[0].redirectTo=N,N.tip.node=n.stack[1].node,k.children[T]=y,w&&w.name==="body"&&S.children.pop(),n.document.body=w=y}case e.table:{let D=new F("#reparented",d);n.tip.fosterParent=D;let N=S.children,z=N.pop();return N.push(D,z)}}}function o(m){let u=n.tip,y=n;return u.redirect&m?y=n.tip.redirectTo||y:u._reopen&m&&(u.kind===d&&!(n.allOpened&e.frameset)?(n._select("html",e.html),n._select("body",e.body),u=n.tip):u.kind&e.html&&(n._select("body",e.body),u=n.tip)),y}function c(m,u=I[m.name]||X){let y=o(u);return u&t.reformat&&y._reformat(),u&t.void?y.tryAppend(m,u,null,u&t.breakout?d:y.tip.namespace):y.tryOpen(m.name,u,m.attributes,u&t.breakout?d:y.tip.namespace),g()}function P(m,u=I[m.name]||X){let S=o(u).tryClose(m.name,u);return g()}function p(m){let u=n.tip.content&t.DATA?t.DATA:t.TEXT,y=o(u);return u&t.reformat&&y._reformat(),y.tryAppend(m,u,null,d),g()}function O(m){let u=o(t.SPACE);return t.SPACE&t.reformat&&u._reformat(),u.tryAppend(m,t.SPACE,null,d),g()}function v(m){let u=o(t.SPACE);return t.SPACE&t.reformat&&u._reformat(),u.tryAppend(m,t.SPACE,null,d),g()}function x(m){return o(t.COMMENT).tryAppend(m,t.COMMENT,null,d),g()}function M(){return r===te&&(k||n.tryOpen("html",e.html),K||n.tryOpen("head",e.head)||k.children.push(new F("head")),w||n.tryOpen("body",e.body)||k.children.push(new F("body"))),g()}}var Zt=console.log.bind(console),on="0.10.0";function rn(r,i={}){let n=new Xe(i),A=new He(n),k=new De(A);return k.parse(r),k.end(),n.document}export{De as Lexer,Xe as Parser,He as Preprocessor,he as TreeBuilderClass,xe as categories,ke as dom,rn as parse,ve as schema,on as version};
