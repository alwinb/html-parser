var Zt=Object.defineProperty;var $e=a=>Zt(a,"__esModule",{value:!0});var Nt=(a,r)=>{$e(a);for(var s in r)Zt(a,s,{get:r[s],enumerable:!0})};var ne={};Nt(ne,{Comment:()=>mt,Doctype:()=>St,Document:()=>_t,Element:()=>V,EndTag:()=>lt,MDecl:()=>ee,htmlns:()=>Jt});var Jt="http://www.w3.org/1999/xhtml",te=!0;function _t(){Object.defineProperties(this,{head:{writable:te},body:{writable:te}}),this.children=[]}function V(a,r){this.name=a,r&&(this.attrs=r),this.children=[]}function St(){this.type="Doctype",this.data=[]}function mt(){this.type="Comment",this.data=[]}function ee(){this.type="MDecl",this.name,this.data=[]}function lt(a){this.type="EndTag",this.name=a}var oe={};Nt(oe,{Any:()=>ft,C:()=>n,E:()=>e,Kind:()=>We,None:()=>w,kinds:()=>W,otherKind:()=>Z,printKind:()=>wt});var zo=console.log.bind(console),Ke=`html body head caption colgroup optgroup option select tr script div
  template col button p table li frameset frame noframes math svg br xmp
  a nobr font textarea meta hr style input keygen annotation-xml embed
  img image noscript title form`.split(/\s+/g),It={RAW:"#data",COMMENT:"#comment",DOCTYPE:"#doctype",SPACE:"#space",TEXT:"#text",h1_h6:"h1 h2 h3 h4 h5 h6",tbody:"tbody tfoot thead",cell:"td th",list:"ol ul",dddt:"dd dt",_fmt0:"b big code em i s small strike strong tt u",_void0:"area wbr",_void1:"param source track",_meta0:"base basefont bgsound link",_break:"sub sup var ruby span",_scope:"applet marquee object",_block1:"blockquote center dl menu",_block2:"listing pre",_block3:`article aside details dir fieldset figcaption
            figure footer header hgroup main nav
            plaintext section summary address`},ht=0n,Ct={},et={};for(let a of Ke)Ct[a]=1n<<ht++;for(let a in It)et[a]=1n<<ht++;et.other=1n<<ht++;et.htmlFont=1n<<ht++;et.hiddenInput=1n<<ht++;et.annotationHtml=1n<<ht++;et.annotationXml=Ct["annotation-xml"];var W={};for(let a in Ct)W[a]=(W[a]||0n)|Ct[a];for(let a in It)for(let r of It[a].split(/\s+/))W[r]=(W[r]||0n)|et[a];function wt(a){if(a===~0n)return"Any";if(a===0n)return"None";let r=a<0n?~a:a,s=[];for(let u in e)r&e[u]&&s.push("E."+u);for(let u in et)et[u]&r&&s.push("C."+u);return`${a<0n?"~":""}`+(s.length===1?s[0]:`(${s.join(" | ")})`)}var e=Ct,n=Object.assign({},et),Z=n.other,w=0n,ft=-1n;n.void=n._void0|n._void1|e.input|e.keygen|e.embed|e.img|n._meta0|e.meta|e.br|e.col|e.frame|e.hr|n.hiddenInput;n.meta=n._meta0|e.noscript|e.title|e.style|e.script|e.template|e.meta|e.noframes;n.format=n._fmt0|e.a|e.font|e.nobr|n.htmlFont;n._specialBlock=n._block1|n._block2|n._block3|e.form;n.special=n._specialBlock|e.p|e.div|e.li|n.list|n.h1_h6|n.dddt|e.button;n.foreign=e.math|e.svg;n.RcData=e.textarea|e.title;n.RawText=e.style|e.script|e.xmp|e.noframes;n.formatContext=e.html|e.template|e.caption|e.table|n.cell|n._scope;n.reformat=n._void0|e.input|e.keygen|n._scope|n.other|n.format|e.select|e.optgroup|e.option|e.button|e.math|e.svg|e.br|e.xmp|n.TEXT|n.SPACE,n.bodyContent=~(e.body|e.html|e.head|e.frameset|e.frame|e.caption|e.colgroup|e.col|n.tbody|e.tr|n.cell|n.RAW|n.DOCTYPE);n.pContent=n.bodyContent&~(e.p|e.div|n._specialBlock|n.dddt|n.h1_h6|n.list|e.li|e.xmp);n.tableIsh=e.table|e.caption|e.colgroup|e.col|n.tbody|e.tr|n.cell;n.tableContent=e.caption|e.colgroup|n.tbody|e.script|e.template|e.style|n.hiddenInput|n.SPACE|n.COMMENT;n.trContent=e.script|e.style|e.template|n.cell|n.hiddenInput|n.SPACE|n.COMMENT;n.tbodyContent=e.script|e.style|e.template|e.tr|n.hiddenInput|n.SPACE|n.COMMENT;n.breakout=e.body|e.br|e.head|e.li|e.p|e.table|e.div|n._block1|n._block2|n._break|e.meta|n._fmt0|e.nobr|n.dddt|n.h1_h6|n.list|e.embed|e.img|e.hr|n.htmlFont;n.foreignContent=~(n.breakout|n.RAW|n.DOCTYPE);n.closeSelect=e.input|e.keygen|e.textarea;n.startTagExceptions=e.select|e.image|e.input|e.font|n.annotationXml|e.a|e.nobr|e.body|e.head|e.frameset;n.endTagExceptions=e.br|e.p|e.body|e.head|n.h1_h6;n.framesetOK=e.optgroup|e.option|e.div|e.p|n.h1_h6|n.list|n.format|n._void1|n._block1|n._block3|e.form|n.other|n.COMMENT|n.SPACE|n.DOCTYPE|e.html|e.head|n._break|n.hiddenInput|e.frame|e.frameset|e.noframes|e.body|e.svg|e.math;n.metaRedirect=n.meta&~e.noscript;n.fosterParented=~(n.tableIsh|e.script|e.template|e.style|n.hiddenInput|n.COMMENT|n.SPACE|n.RAW|n.DOCTYPE);var We=a=>W[a]||Z;var fe={};Nt(fe,{childRule:()=>qt,documentRule:()=>Et,fragmentRule:()=>Qe,ruleInfo:()=>Ft,siblingRule:()=>Yt});var Jo=console.log.bind(console);function Ft(a){let r=Object.assign({},a);for(let s in r)typeof r[s]=="bigint"&&(r[s]=wt(r[s]));return r}var Ge={},Et={name:"#document",state:e.html,content:e.html|n.COMMENT|n.DOCTYPE,openFor:~(n.SPACE|n.DOCTYPE),paths:{"#default":"html"},siblingRules:!0},Qe={name:"#fragment",state:e.html,escalate:w,content:n.bodyContent},Ue={name:"beforeDoctype",content:e.html|n.COMMENT|n.DOCTYPE,openFor:~(n.SPACE|n.DOCTYPE),paths:{"#default":"html"},siblingRules:!0},ze={name:"beforeHtml",content:e.html|n.COMMENT,openFor:~(n.SPACE|n.DOCTYPE),paths:{"#default":"html"},siblingRules:!0},Ze={escalate:w,content:w},Je={content:n.COMMENT},ae={content:e.head|n.COMMENT,openFor:~(n.SPACE|n.DOCTYPE),paths:{"#default":"head"},siblingRules:!0},tn={closable:w,escalate:w,content:e.body|e.frameset|n.COMMENT|n.SPACE,openFor:~(n.metaRedirect|e.frame|e.frameset|n.SPACE|n.DOCTYPE),paths:{"#default":"body"},reparent:n.metaRedirect,siblingRules:!0},en={closable:w,escalate:w},nn={escalate:w,content:e.noframes|n.SPACE|n.COMMENT},on={closable:w,escalate:~(e.frame|e.head|n.DOCTYPE),content:n.meta|n.SPACE|n.COMMENT},an={closable:w,escalate:w,content:n.bodyContent,reparent:e.frameset},rn={escalate:w,content:e.frameset|e.frame|e.noframes|n.SPACE|n.COMMENT},sn={state:e.html|e.table,closable:w,escalate:e.table,content:n.tableContent,openFor:e.col|e.tr|n.cell,paths:{col:"colgroup",tr:"tbody",td:"tbody",th:"tbody"},reparent:n.fosterParented},ln={closable:e.table,content:n.bodyContent},cn={closable:e.table,content:e.col|n.hiddenInput|e.template|n.SPACE,escalate:ft,reparent:w},Bt={closable:e.table,escalate:n.tableIsh&~(e.tr|n.cell),openFor:n.cell,paths:{td:"tr",th:"tr"},content:n.tbodyContent,reparent:n.fosterParented},fn={closable:e.table|n.tbody,escalate:n.tableIsh&~n.cell,content:n.trContent,reparent:n.fosterParented},re={closable:e.table|e.tr|n.tbody,escalate:n.tableIsh,content:n.bodyContent},un={state:e.html|e.select,closable:w,escalate:n.closeSelect,content:e.option|e.optgroup|e.script|e.template|n.TEXT|n.SPACE|n.COMMENT},pn={content:e.option|e.script|e.template|n.TEXT|n.SPACE,forbid:e.optgroup},dn={content:e.script|e.template|n.TEXT|n.SPACE|n.COMMENT,escalate:n.closeSelect|n.tableIsh|e.option|e.optgroup},se=n.tableIsh&~(e.colgroup|e.col),mn={state:e.html|e.select,closable:n.tableIsh,escalate:n.closeSelect|se,content:e.option|e.optgroup|e.script|e.template|n.TEXT|n.SPACE},jt={closable:n.tableIsh,escalate:n.tableIsh,content:n.bodyContent},hn={content:n.bodyContent},ut=e.option|e.optgroup|n.other|e.svg|e.math|e.body,le={closable:~(ut|e.form|e.li),allow:n.bodyContent&~e.button},bn={closable:~(ut|e.form),allow:n.bodyContent&~e.button},gn={closable:~(ut|e.form|e.p),allow:n.bodyContent&~e.button,forbid:e.button},yn={escalate:~e.form,allow:n.bodyContent&~(e.button|e.form),forbid:e.form},Tn={closable:~(ut|e.form),allow:n.bodyContent&~(e.button|e.form|n.h1_h6),forbid:n.h1_h6},Cn={closable:~ut,allow:n.bodyContent&~(e.button|e.form|e.li),forbid:e.li},ie={closable:~ut,allow:n.bodyContent&~(e.button|e.form|n.dddt),forbid:n.dddt},wn={state:e.html|e.p,closable:~ut,allow:n.pContent&~e.button,forbid:~n.pContent},En={closable:~(e.svg|e.math|e.body),allow:(n.pContent|n.h1_h6)&~e.button,forbid:e.option|e.optgroup},Lt={closable:~(e.svg|e.math|e.form|e.body),allow:(n.pContent|n.h1_h6)&~e.button},nt={content:n.SPACE|n.RAW,escalate:ft},kt={state:e.svg,closable:~(e.html|e.body),escalate:n.breakout,content:n.foreignContent},Ht={state:e.svg|e.table,closable:~(e.html|e.body),escalate:n.breakout|(e.tr|n.tbody|n.cell),content:n.foreignContent&~(e.tr|n.tbody|n.cell)},xt={state:e.math,closable:~(e.html|e.body),escalate:n.breakout|se,content:n.foreignContent},ot={state:e.html,closable:e.svg|e.math,escalate:w,content:n.bodyContent},Ot={state:e.html|e.table,closable:e.svg|e.math|n.tableIsh,escalate:n.tableIsh,content:n.bodyContent},ce={html:ae,head:on,body:an,frameset:rn,template:{closable:w,content:~(e.body|e.frameset|e.frame|n.RAW)},applet:jt,object:jt,marquee:jt,svg:kt,math:xt,select:un,option:En,dl:bn,ol:le,ul:le,li:Cn,dt:ie,dd:ie,form:yn,button:gn,p:wn,div:Lt,address:Lt,style:nt,script:nt,xmp:nt,iframe:nt,noembed:nt,noframes:nt,textarea:nt,title:nt,plaintext:nt,"#comment":nt,table:sn,caption:ln,colgroup:cn,thead:Bt,tbody:Bt,tfoot:Bt,tr:fn,th:re,td:re},xn={svg:Ht,select:mn},Dn={option:dn,optgroup:pn},An={svg:kt,math:xt,foreignObject:ot,title:ot,desc:ot},_n={svg:Ht,math:xt,foreignObject:Ot,title:Ot,desc:Ot},Sn={svg:kt,math:xt,mi:ot,mo:ot,mn:ot,ms:ot,mtext:ot};function qt(a,r,s){if(a&e.math)return s&n.annotationHtml?a&e.table?Ot:ot:Sn[r]||xt;if(a&e.svg)return a&e.table?_n[r]||Ht:An[r]||kt;let u;return a&e.table&&(u=xn[r])||a&e.select&&(u=Dn[r])?u:s&n.h1_h6?Tn:r in ce?ce[r]:s&n._specialBlock?hn:a&e.p?Ge:Lt}function Yt({kind:a,children:r},s,u,l){return a===w?r&e.html?l&e.frameset?Je:Ze:r&n.DOCTYPE?ze:Ue:a&e.html?r&e.frameset?nn:r&e.body?en:r&e.head?tn:ae:null}function*ue(a,r=1/0){for(;a<=r;)yield a++}var kn=(a,r=0)=>new Proxy({},{get:(s,u)=>(a[u]=r,r++)}),ta=console.log.bind(console),On=(()=>{let[a,r,s,u,l,$,E,I,q,D,x,c,A,F,f,m,N,H,j,U,z]=ue(1),k=i=>i===0?a:i===13?r:i===10?s:i===9||i===32?E:i===33?A:i===34?l:i===35?q:i===38?D:i===39?$:i===45?F:i===47?N:48<=i&&i<=57?H:i===59?I:i===60?f:i===61?x:i===62?m:i===63?c:65<=i&&i<=70?j:71<=i&&i<=90?U:i===88?z:97<=i&&i<=102?j:102<=i&&i<=122?U:i===120?z:u,S=[];for(let i=0,J=122;i<=J;i++)S[i]=k(i);return S})(),Pn=0,Pt={errorToken:Pn},{plaintext:Rn,rawtext:pe,rcdata:de,nulls:Mn,space:vn,newline:me,other:he,data:Nn,ampersand:In,lt:Fn,charRefDecimal:be,charRefHex:ge,charRefNamed:Bn,charRefLegacy:jn,mDeclStart:Ln,commentStart:Hn,commentData:Xt,commentEnd:qn,bogusStart:ye,bogusData:Yn,bogusEnd:Xn,startTagStart:Vn,endTagStart:$n,tagSpace:ea,tagEnd:Kn,attributeSep:Te,attributeName:Wn,attributeAssign:Gn,valueStartApos:Qn,valueStartQuot:Un,valueEnd:zn,unquoted:Zn,squoted:Jn,quoted:to}=kn(Pt,1),eo=[];for(let a in Pt)eo[Pt[a]]=a;var[Ce,no,oo,ao,ro,so,lo,io,co,fo,uo,po,we,mo,Ee,xe,ho,bo,B,at,De,it,bt,v,tt,d,h,b,g,O,P,_,o,go,yo,Q,gt,pt,Rt,Ae,To,Co,_e,Y,L,X,wo,Eo,xo,yt,Do,Mt,Dt,Ao,_o,Se,So,ko,Oo,rt]=ue(1),Po=0,Ro={Main:Ce,RcData:no,RawText:oo,PlainText:B,BeforeAttribute:ao,BeforeAssign:ro,BeforeValue:so,BeforeCommentData:lo,InCommentData:io,Bogus:co,ValueQuoted:fo,ValueAposed:uo,ValueUnquoted:po},t=Po,Mo=B,vo=[[0,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[0,at,it,rt,v,v,v,De,v,v,gt,v,v,v,v,To,v,v,v,v,v,v],[0,at,it,rt,h,h,h,h,h,h,gt,h,h,h,h,Eo,h,h,h,h,h,h],[0,at,it,rt,d,d,d,d,d,d,d,d,d,d,d,wo,d,d,d,d,d,d],[0,b,Q,Q,b,b,b,Q,b,b,b,b,b,b,b,b,yt,Q,b,b,b,b],[0,b,bt,bt,b,b,b,bt,b,b,b,Dt,b,b,b,b,yt,Q,b,b,b,b],[0,g,t,t,g,Ao,_o,t,g,g,gt,g,g,g,g,g,yt,g,g,g,g,g],[0,at,it,rt,o,o,o,o,o,o,o,o,o,o,yo,o,Mt,o,o,o,o,o],[0,at,it,rt,o,o,o,o,o,o,o,o,o,o,go,o,o,o,o,o,o,o],[0,at,it,rt,_,_,_,_,_,_,_,_,_,_,_,_,Do,_,_,_,_,_],[0,at,it,rt,O,Se,O,O,O,O,gt,O,O,O,O,O,O,O,O,O,O,O],[0,at,it,rt,P,P,Se,P,P,P,gt,P,P,P,P,P,P,P,P,P,P,P],[0,g,Q,Q,g,g,g,Q,g,g,gt,g,g,g,g,g,yt,g,g,g,g,g],[0,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,L,L,L],[0,t,t,t,t,t,t,t,t,t,t,t,t,t,xo,t,t,t,t,t,t,t],[0,o,o,o,o,o,o,o,o,o,o,o,o,xe,t,o,Mt,o,o,o,o,o],[0,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,Mt,o,o,o,o,o],[0,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,Ae,t,t,bo],[0,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,Rt,Rt,t,t],[Rn,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B],[Mn,at,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[vn,t,t,t,t,t,t,De,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[me,t,t,rt,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[Te,t,bt,bt,t,t,t,bt,t,t,t,Dt,t,t,t,t,yt,Q,t,t,t,t],[Nn,t,t,t,v,v,v,t,v,v,t,v,v,v,v,t,v,v,v,v,v,v],[he,t,t,t,tt,tt,tt,t,tt,tt,t,tt,tt,tt,tt,t,tt,tt,t,t,t,t],[pe,t,t,t,d,d,d,d,d,d,d,d,d,d,d,t,d,d,d,d,d,d],[de,t,t,t,h,h,h,h,h,h,t,h,h,h,h,t,h,h,h,h,h,h],[Wn,b,t,t,b,b,b,t,b,b,b,t,b,b,b,b,t,t,b,b,b,b],[Zn,g,t,t,g,g,g,t,g,g,t,g,g,g,g,g,t,g,g,g,g,g],[to,t,t,t,O,t,O,O,O,O,t,O,O,O,O,O,O,O,O,O,O,O],[Jn,t,t,t,P,P,t,P,P,P,t,P,P,P,P,P,P,P,P,P,P,P],[Yn,t,t,t,_,_,_,_,_,_,_,_,_,_,_,_,t,_,_,_,_,_],[Xt,t,t,t,o,o,o,o,o,o,o,o,o,o,t,o,o,o,o,o,o,o],[Xt,t,t,t,o,o,o,o,o,o,o,o,o,o,Ee,o,o,o,o,o,o,o],[Xt,t,t,t,o,o,o,o,o,o,o,o,o,xe,Ee,o,Mt,o,o,o,o,o],[Te,t,Q,Q,t,t,t,Q,t,t,t,t,t,t,t,t,yt,Q,t,t,t,t],[In,t,t,t,t,t,t,t,t,ho,t,t,t,t,t,t,t,t,t,pt,pt,pt],[jn,t,t,t,t,t,t,t,So,t,t,t,t,t,t,t,t,t,pt,pt,pt,pt],[ge,t,t,t,t,t,t,t,Oo,t,t,t,t,t,t,t,t,t,Rt,Rt,t,t],[be,t,t,t,t,t,t,t,ko,t,t,t,t,t,t,t,t,t,Ae,t,t,t],[Fn,t,t,t,t,t,t,t,t,t,t,t,_e,_e,t,t,t,Co,t,Y,Y,Y],[ye,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,L,L,L],[ye,t,t,t,t,t,t,t,t,t,t,t,t,t,mo,t,t,t,t,X,X,X],[Vn,Y,t,t,Y,Y,Y,t,Y,Y,Y,Y,Y,Y,Y,Y,t,t,Y,Y,Y,Y],[$n,L,t,t,L,L,L,t,L,L,L,L,L,L,L,L,t,t,L,L,L,L],[Ln,X,t,t,X,X,X,t,X,X,X,X,X,X,X,X,t,t,X,X,X,X],[pe,t,t,t,d,d,d,d,d,d,d,d,d,d,d,t,d,we,d,d,d,d],[de,t,t,t,h,h,h,h,h,h,h,h,h,h,h,t,h,we,h,h,h,h],[Hn,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[Kn,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[Xn,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[qn,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[Gn,t,Dt,Dt,t,t,t,Dt,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[Un,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[Qn,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[zn,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[Bn,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[be,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[ge,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[me,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t]],No={eqClass:On,defaultClass:he,tokens:Pt,states:Ro,table:vo,initialState:Ce,minAccepts:Mo},Vt=No;var{eqClass:Io,defaultClass:Fo,tokens:M,states:R,initialState:ke,table:Oe,minAccepts:Bo}=Vt,sa=console.log.bind(console),jo=0,Lo=0,$t=[];for(let a in M)$t[M[a]]=a;R.PlainText=R.RawText;var Ho={style:R.RawText,script:R.RawText,xmp:R.RawText,iframe:R.RawText,noembed:R.RawText,noframes:R.RawText,textarea:R.RcData,title:R.RcData,plaintext:R.PlainText};function Pe(a){let r=ke,s=0,u=0,l=0,$=1,E=0,I=0,q=!1,D="",x,c=null,A,F;function f(){r=ke,s=u=l=0,$=1,E=I=0,q=!1,D="",x=c=A=F=null}this.parse=function(m){this.write(m),this.end()},this.write=function(N){let H=N.length;for(;l<H;){let j=r,U=jo;do{let S=N.charCodeAt(l++);j=Oe[j][S<=122?Io[S]:Fo],Bo<=j&&(U=j,u=l),(S===13||S===10)&&(E=l,$+=I!==13),I=S}while(j&&l<H);let z=Oe[U][0],k=$t[z];switch(z){case Lo:{let i=`Lexer error at line ${$}:${l-E}`;throw new SyntaxError(i)}break;case M.startTagStart:D=N.substring(s+1,u).toLowerCase(),x=new V(D),F=a.writeTag,r=R.BeforeAttribute;break;case M.endTagStart:{let i=N.substring(s+2,u).toLowerCase();r===R.Main||D===i?(x=new lt(i),F=a.writeEndTag,r=R.BeforeAttribute):a.writeData(N.substring(s,u))}break;case M.attributeName:{x.attrs=x.attrs||{},c&&(x.attrs[c[0]]=c[1]);let i=N.substring(s,u);c=i in x.attrs?null:[i,""],r=R.BeforeAssign}break;case M.unquoted:c&&(c[1]+=N.substring(s,u)),r=R.ValueUnquoted;break;case M.squoted:case M.quoted:c&&(c[1]+=N.substring(s,u));break;case M.tagEnd:c&&(x.attrs[c[0]]=c[1],c=null),N[u-2]==="/"&&(x.selfclose=!0),q=F(x)?.xmlIsh,r=x instanceof V&&!q?Ho[D]||R.Main:D==="plaintext"?R.PlainText:R.Main,x=c=null,s=l=u;break;case M.mDeclStart:x=new St,F=a.writeDoctype,r=R.Bogus;break;case M.commentStart:x=new mt,F=a.writeComment,r=R.BeforeCommentData;break;case M.bogusStart:x=new mt,F=a.writeComment,r=R.Bogus;break;case M.bogusData:x.data.push(N.substring(s,u)),r=R.Bogus;break;case M.commentData:x.data.push(N.substring(s,u)),r=R.InCommentData;break;case M.commentEnd:case M.bogusEnd:F(x),x=c=null,s=l=u,r=R.Main;break;case M.nulls:if(q||r!==R.Main){let i="";for(let J=0,ct=u-s;J<ct;J++)i+="\uFFFD";a.writeData(i)}break;case M.newline:case M.space:x?c&&(r=R.BeforeAttribute):a.writeSpace(N.substring(s,u));break;case M.rawtext:case M.rcdata:case M.other:case M.data:case M.ampersand:case M.lt:a.writeData(N.substring(s,u));break;case M.charRefNamed:let S=N.substring(s+1,u-1);a.writeData({lt:"<",amp:"&"}[S]||"");break;case M.attributeSep:r=R.BeforeAttribute;break;case M.attributeAssign:r=R.BeforeValue;break;case M.valueStartQuot:r=R.ValueQuoted;break;case M.valueStartApos:r=R.ValueAposed;break;case M.valueEnd:r=R.BeforeAttribute;break;default:throw new Error("unknown token "+$t[z])}s=l=u}},this.end=function(){x instanceof mt&&a.writeComment(x),a.writeEOF(),f()}}var{defineProperty:Re,assign:qo,setPrototypeOf:Yo}=Object,Me=!0,ve=(a,r)=>{for(let s in r)Re(a,s,{value:r[s],configurable:Me})},Xo=(a,r)=>{for(let s in r)Re(a,s,{get:r[s],configurable:Me})},ia=console.log.bind(console),Vo=wt,Kt=({childRule:a,siblingRule:r,ruleInfo:s})=>{class u{constructor(E,I){let q={state:w,name:E.name,kind:w,closable:w,openable:w,content:w,node:E};return this.applyRule.call(q,I)}applyRule(E,{name:I,kind:q,node:D,children:x=w}=this){let{state:c=this.state,closable:A=ft,escalate:F=ft,content:f=this.content,allow:m=w,forbid:N=w,openFor:H=w,paths:j=null,reparent:U=w,fosterParent:z=this.fosterParent,siblingRules:k=!1}=E,S=(f|U|m)&~N,i=Yo({state:c,name:I,kind:q,children:x,closable:this.closable&A,openable:this.openable&F|S|H,content:S,openFor:H,paths:j,reparent:U,fosterParent:z,siblingRules:k,node:D},u.prototype);return ve(D,{frame:i}),i}child(E,I,q,D=new V(E,q)){let x=a(this.state,E,I,this.children),c=this.applyRule(x,{name:E,kind:I,node:D});return c.closable|=I,c}_select(E,I){for(let q of this.node.children)if(q.name===E)return this.child(E,I,null,q);return null}get info(){let E=qo({},this);for(let I in E)typeof E[I]=="bigint"&&(E[I]=Vo(E[I]));return E.fosterParent=this.fosterParent?.name,delete E.node,E}}function l({context:$,node:E,minDepth:I=1,verbose:q=!1}){let D=this,x,c,A,F,f,m,N=w,H,j=w,U;return Xo(this,{stack:()=>A,tip:()=>c,document:()=>x,allOpened:()=>f,allClosed:()=>m}),ve(this,{reset:z,_onopen:k,_onclose:S,log:Ut,prepare:i,tryOpen:J,tryAppend:ct,tryClose:dt,_open:st,_select:Ve,_reformat:qe,canClose:Qt}),z();function z(){return x=E||new V($.name||"#root"),c=new u(x,$),A=[c],F=[],f=w,m=w,D}function k(T,p){N=T,H=p}function S(T,p){j=T,U=p}function i(T,p){for(let C=0;C<3;C++){if(p&c.content)return D;let y=Ye(T,p);if(y){let G=Tt(y.index+1);if(y.done)return D}let K=Xe(T,p);if(K&&K.path.length){for(let G of K.path){let vt=c.reparent&p?c.fosterParent:c.node,zt=vt.children.length;vt.children[zt]=G.node,c.children|=G.kind,A.push(c=G),f|=G.kind,N&G.kind&&H(G.name,G.kind,G.node,vt,zt)}if(K.done)return D}}return null}function J(T,p=W[T]||Z,C){return i(T,p)?st(T,p,C):null}function ct(T,p=W[T]||Z){if(i(T?T.name:null,p)){if((c.reparent&p?c.fosterParent:c.node).children.push(T),c.children|=p,f|=p,c.siblingRules){let y=r(c,T.name,p,f);Ut(y),y!=null&&(A[A.length-1]=c=c.applyRule(y))}return D}return null}function dt(T,p=W[T]||Z){let C=Qt(T,p);return C&&Tt(C.index)?D:null}function st(T,p,C){let y=c.child(T,p,C),K=c.reparent&p?c.fosterParent:c.node,G=K.children.length;return K.children[G]=y.node,c.children|=p,A.push(c=y),f|=p,N&p&&H(T,p,y.node,K,G),D}function Tt(T=A.length-1){if(T<I)return null;let p=[],C=w,y;for(;A.length>T;){let K=A.pop();C=K.kind,y=K.name,m|=K.kind,p.push(K),F.push(K)}return C&n.format&&F.length&&F.pop(),c=A[A.length-1],c.siblingRules&&He(y,C),p}function He(T,p){A.pop();let C=r(c,T,p,f);C!=null&&(A[A.length]=c=c.applyRule(C))}function qe(){let T={},p=[];for(let{name:C,kind:y}of F)y&n.format?(T[C]=(T[C]||0)+1)<=3&&p.unshift({name:C,kind:y}):y&n.formatContext&&(T={},p=[]);for(let{name:C,kind:y}of p)D.tryOpen(C,y);F=[]}function Qt(T,p){for(let C=A.length-1;C>=0;C--){let y=A[C];if(T===null){if(y.kind&p)return{index:C,frame:y}}else if(y.name&&y.name.toLowerCase()===T.toLowerCase())return{index:C,frame:y};if(!(y.closable&p))return null}}function Ye(T,p){if(p&c.openable)for(let C=A.length-1;C>=0;C--){let y=A[C];if(p&y.content)return{index:C,frame:y,done:!0};if(p&y.openFor)return{index:C,frame:y,done:!1}}}function Xe(T,p){let C=[],y=c,K;if(p&c.openFor)for(;y&&!(y.content&p)&&y.openFor&p;){let G=T in y.paths?y.paths[T]:y.paths["#default"];y=y.child(G,W[G]||Z),C.push(y)}return C.length?{path:C,done:y.content&p}:null}function Ve(T,p){let C=c._select(T,p);return C&&A.push(c=C),C?D:null}function Ut(...T){return q&&console.log(`
`+A.map(p=>p.name).join(" > "),...T.length?["::",...T]:[]),D}}return l};var{defineProperty:Ne,assign:pa,setPrototypeOf:da}=Object,Ie=!0,Fe=(a,r)=>{for(let s in r)Ne(a,s,{value:r[s],configurable:Ie})},$o=(a,r)=>{for(let s in r)Ne(a,s,{get:r[s],configurable:Ie})},ma=console.log.bind(console),Ko=Kt({childRule:qt,siblingRule:Yt,ruleInfo:Ft}),Wo={altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient",textpath:"textPath"},At=e.svg|e.math,Be=e.table|e.caption|n.tbody|e.tr;n.endTagExceptions=n.endTagExceptions|e.body|e.html|e.frameset;var Wt=e.table|e.select|e.caption|n.cell,Go={color:1,face:1,size:1};function Qo({name:a,attrs:r}){let s=W[a]||Z;if(s===e.input&&r&&r.type&&r.type.toLowerCase()==="hidden")return n.hiddenInput;if(s===e.font){for(let u in r)if(u.toLowerCase()in Go)return n.htmlFont}if(s===n.annotationXml&&r&&r.encoding){let u=r.encoding.toLowerCase();if(u==="text/html"||u==="application/xhtml+xml")return n.annotationHtml}return s}function je(a){let r=n.SPACE,s=[],u=null,l={state:e.html,kind:0n,closable:0n,allOpened:0n,allClosed:0n};Fe(this,{writeTag:$,writeEndTag:E,writeSpace:I,writeData:q,writeComment:x,writeDoctype:D,writeEOF:c});function $(f){A(),r=n.SPACE;let{state:m,closable:N,allOpened:H}=l,j=Qo(f);switch(j&n.startTagExceptions){case e.body:case e.head:return l=m&At?a.writeEndTag(new lt(m&e.svg?"svg":"math")):a.writeTag(f);case e.select:return l=m&e.select&&m&e.html?a.writeEndTag(new lt("select")):a.writeTag(f);case e.frameset:return m&At?l=a.writeTag(f):H&~n.framesetOK?l:l=a.writeTag(f);case e.image:return l=a.writeTag(m&e.html?new V("img",f.attrs):f);case e.a:return N&e.a&&m&e.html&&(l=a.writeEndTag(f)),l=a.writeTag(f);case e.nobr:return N&e.nobr&&m&e.html&&(l=a.writeEndTag(f)),l=a.writeTag(f)}return f.selfclose&&m&At?(l=a.writeTag(f),l=a.writeEndTag(new lt(f.name))):(m&e.svg&&(f=F(f)),l=a.writeTag(f,j))}function E(f){A(),r=n.SPACE;let m=W[f.name]||Z,{state:N,closable:H,allOpened:j}=l;if(m&n.endTagExceptions){if(m&e.body)return(!(l.allClosed&e.head)||H&e.head)&&(l=a.writeTag(new V("body"))),l.allOpened&e.body&&!(l.closable&Wt)?(u="afterBody",l):l=a.writeEndTag(f);if(m&e.html)return j&e.html&&!(H&Wt)&&(u="afterAfterBody"),l;if(m&e.frameset)return j&m&&!(H&Wt)&&(u="afterFrameset"),l=a.writeEndTag(f);if(m&e.br)return l=a.writeTag(new V("br"));if(m&H&n.h1_h6)return l=a.writeEndTag({name:null,kind:m},m);if(m&e.p&&!(H&e.p)&&j&e.body||m&e.head&&!(j&e.head))return a.writeTag(new V(f.name)),l=a.writeEndTag(new lt(f.name))}return l=a.writeEndTag(f)}function I(f){return l.kind&Be?(s.push(f),l):(u=null,a.writeSpace(f))}function q(f){return r=l.kind&Be?n.TEXT:n.SPACE,A(),l=a.writeData(f)}function D(f){return A(),l=a.writeDoctype(f)}function x(f){let m=u;switch(A(),m){case"afterBody":case"afterFrameset":return a.appendToHtml(f),u=m,l;break;case"afterAfterBody":return a.appendToDocument(f),u=m,l;break;default:return l=a.writeComment(f)}}function c(){return A(),l=a.writeEOF()}function A(f=r){u=null;for(let m of s)a.writeSpace(m,f);s=[]}function F(f){let m=f.name;return m=Wo[m]||m,f.name===m?f:new V(m,f.attributes)}}function Le({context:a=Et,verbose:r=!1}={}){let s=new Ko({node:new _t,context:a,verbose:r,documentRule:Et}),u=e.html|e.head|e.body|e.frameset|e.table;s._onopen(u,x);let l,$,E,I,q=this;return $o(this,{document:()=>s.document,stack:()=>s.stack,builder:()=>s}),Fe(this,{writeTag:c,writeEndTag:A,writeData:F,writeSpace:f,writeComment:N,writeDoctype:m,writeEOF:H,appendToHtml:U,appendToDocument:j}),this;function D(k=!1,S=null){let{allClosed:i,allOpened:J}=s,{state:ct,kind:dt,closable:st}=s.tip;return{state:ct,kind:dt,closable:st,allOpened:J,allClosed:i,xmlIsh:!!(st&At)}}function x(k,S,i,J,ct){switch(S){case e.html:return l=i;case e.head:return s.document.head=$=i,s.stack[1].fosterParent=$,l;case e.body:return I=ct,s.document.body=E=i;case e.frameset:return s.tip.state&At?void 0:(l.children[I]=i,E&&E.name==="body"&&J.children.pop(),s.document.body=E=i);case e.table:{let dt=new V("#reparented",w);s.tip.fosterParent=dt;let st=J.children,Tt=st.pop();return st.push(dt,Tt)}}}function c(k,S=W[k.name]||Z){if(S&n.reformat&&s._reformat(),S&n.void)s.tryAppend(k,S);else if(S&n.RawText&&s.tip.state&e.html){let i=s.tryOpen(k.name,S,k.attributes);return D(!0)}else s.tryOpen(k.name,S,k.attributes);return D()}function A(k,S=W[k.name]||Z){let i=s.tryClose(k.name,S);return D()}function F(k){let S=s.tip.content&n.RAW||n.TEXT;return S&n.reformat&&s._reformat(),s.tryAppend(k,S),D()}function f(k,S=n.SPACE){return S&n.reformat&&s._reformat(),s.tryAppend(k,S),D()}function m(k){return s.tryAppend(k,n.DOCTYPE),D()}function N(k){return s.tryAppend(k,n.COMMENT),D()}function H(){return a===Et&&(l||s.tryOpen("html",e.html),$||s.tryOpen("head",e.head)||l.children.push(new V("head")),E||s.tryOpen("body",e.body)||l.children.push(new V("body"))),D()}function j(k){s.document.children.push(k)}function U(k){l&&l.children.push(k)}function z(k){$&&$.children.push(k)}}var Da=console.log.bind(console),Aa=Symbol("DOCTYPE"),_a=Symbol("START"),Sa=Symbol("END"),ka=Symbol("DATA"),Oa=Symbol("MDECL"),Pa=Symbol("COMMENT"),Ra=globalThis.window??{};var Gt=new TextDecoder;Gt=Gt.decode.bind(Gt);var va=console.log.bind(console),La="0.12.1";function Ha(a,r={}){let s=new Le(r),u=new je(s),l=new Pe(u);return l.parse(a),l.end(),s.document}export{Vt as DFA,Le as Parser,je as Preprocessor,Pe as Tokeniser,Kt as TreeBuilderClass,oe as categories,ne as dom,Ha as parse,fe as schema,La as version};
